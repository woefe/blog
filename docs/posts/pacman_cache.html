<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Woefe's Blog
            
                - Don't forget to clean your pacman cache!
            
        </title>
        <link rel="icon" type="image/png" href="../images/favicon.png">
        <link rel="stylesheet" href="../css/default.css" />
        <link rel="stylesheet" href="../css/syntax.css" />
    </head>
    <body>
        <header>
            <div class="logo">
                <a href="../">Woefe's Blog</a>
            </div>
        </header>

        <main>
            <article class="post">
    <h1 class="post_title">Don't forget to clean your pacman cache!</h1>
    <section class="post_header">
        Posted on March 26, 2017
        
    </section>
    <section>
        <p>Arch Linux’ package manager <strong>pacman</strong> stores all downloaded packages in <code>/var/cache/pacman/pkg</code>.
This cache does not get cleaned automatically and pacman keeps adding new archives with every single system update.
If you forget about the pacman cache for a couple of months it takes up more and more space.
I recently freed over 12GB on my SSD by running the cleanup commands listed below.</p>
<!--more-->
<h1 id="cleanup">Cleanup</h1>
<p>To see how much space the cleanup command would save you can use <code>paccache -dk2 &amp;&amp; paccache -duk0</code>.
And to actually clean the pacman cache use following command:</p>
<pre class="shell"><code>sudo paccache -vrk2 &amp;&amp; sudo paccache -vruk0</code></pre>
<p>The first part of the command keeps the two latest versions of each package and removes the rest.
The second part removes all versions of packages which are not installed anymore.
Note that removing all packages from the cache is usually a bad idea, because in case an updated package has a bug you can still install an older version from the cache which does not suffer from the bug.</p>
<h1 id="pacaur">Pacaur</h1>
<p>Pacaur, currently my favourite AUR helper and pacman wrapper, maintains its own cache for AUR packages in
<code>~/.cache/pacaur/</code>. This cache directory grows rapidly if you install huge packages that update often, e.g. the
Jetbrains IDEs. The following command cleans the pacaur cache</p>
<pre class="shell"><code>pacaur -Sac</code></pre>
<h1 id="zsh-alias">Zsh alias</h1>
<p>I have realized that cleaning the pacman and pacaur caches should be a (semi-)regular system maintenance task,
especially on a 120GB SSD, where disk space is very limited. That’s why I added the <code>pacclean</code> alias to my zshrc:</p>
<pre class="shell"><code>alias pacclean='sudo paccache -vrk2 &amp;&amp; sudo paccache -vruk0 &amp;&amp; pacaur -Sac --noconfirm'</code></pre>
<h1 id="update-2018">Update (2018)</h1>
<p>I switched to pikaur, since pacaur has been deprecated for a while now.
Pikaur maintains its own cache, which can be managed with the <code>paccache</code> command.
Meanwhile I use a <a href="https://github.com/woefe/dotfiles/blob/master/scripts/.bin/pacclean">small script</a> to clean the cache and remove unused packages.</p>
    </section>
</article>

        </main>

        <footer>
    <nav>
        <a href="../">Home</a>
        ·
        <a href="../about.html">About</a>
        ·
        <a href="../contact.html">Contact</a>
        ·
        <a href="../archive.html">Archive</a>
        ·
        <a href="../atom.xml">Feed</a>
    </nav>
    <hr>
    Site proudly generated by
    <a href="http://jaspervdj.be/hakyll">Hakyll</a>
</footer>

    </body>
</html>
